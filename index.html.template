<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assignment Tracker</title>
    <link rel="stylesheet" href="styles.css" />
    <script id="assignment-data">window.assignment_data = {{ASSIGNMENT_DATA}};</script>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Assignment Tracker</h1>
        <div class="last-updated">
          <span id="lastUpdated">Last updated: Loading...</span>
          <button id="refreshBtn" class="refresh-btn">Refresh Data</button>
        </div>
      </header>

      <div id="error-box" class="error-box hidden">
        <div class="error-header">
          <span>Encountered Errors</span>
          <button id="error-close-btn" class="error-close-btn">&times;</button>
        </div>
        <div id="error-messages" class="error-messages"></div>
      </div>

      <main>
        <!-- Upcoming Assignments Calendar Section -->
        <section class="upcoming-section">
          <h2>Upcoming Assignments</h2>

          <!-- Calendar Navigation -->
          <div class="calendar-nav">
            <button id="prevMonth" class="nav-btn">&lt;</button>
            <h3 id="currentMonth">Loading...</h3>
            <button id="nextMonth" class="nav-btn">&gt;</button>
          </div>

          <!-- Calendar Table -->
          <div class="calendar-container">
            <table
              class="calendar-table"
              id="calendarTable"
              aria-label="Calendar">
              <thead>
                <tr id="calendarHead">
                  <!-- Day headers populated by JavaScript -->
                </tr>
              </thead>
              <tbody id="calendarBody">
                <!-- Calendar days populated by JavaScript -->
              </tbody>
            </table>
            <div
              id="classLegend"
              class="class-legend"
              aria-label="Class color legend"></div>
          </div>

          <!-- Assignment Details Modal -->
          <div id="assignmentModal" class="modal">
            <div class="modal-content">
              <span class="close">&times;</span>
              <h3 id="modalTitle">Assignment Details</h3>
              <div id="modalBody">
                <!-- Assignment details will be populated here -->
              </div>
            </div>
          </div>

          <!-- Upcoming Assignments List (below calendar) -->
          <div class="assignments-list-section">
            <h3>All Upcoming Assignments</h3>
            <div id="upcomingList" class="assignments-list">
              <!-- Upcoming assignments list will be populated by JavaScript -->
            </div>
          </div>
        </section>

        <!-- Missing Assignments Section -->
        <section class="missing-section">
          <h2>Missing Assignments</h2>
          <div id="missingList" class="assignments-list missing-assignments">
            <!-- Missing assignments will be populated by JavaScript -->
          </div>
        </section>

        <!-- Statistics Section -->
        <section class="stats-section">
          <h2>Summary</h2>
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-number" id="totalUpcoming">0</span>
              <span class="stat-label">Upcoming</span>
            </div>
            <div class="stat-card">
              <span class="stat-number" id="totalMissing">0</span>
              <span class="stat-label">Missing</span>
            </div>
            <div class="stat-card">
              <span class="stat-number" id="totalAssignments">0</span>
              <span class="stat-label">Total</span>
            </div>
          </div>
        </section>
      </main>

      <footer>
        <p>Assignment data automatically collected from multiple sources</p>
        <div id="loadingIndicator" class="loading hidden">
          <span>Loading assignments...</span>
        </div>
      </footer>
    </div>

    <script src="script.js?v=1728000001"></script>

    <!-- Templates for dynamic content -->
    <template id="assignment-item-template">
      <div class="assignment-item">
        <div class="assignment-header">
          <div class="assignment-name"></div>
          <div class="assignment-meta">
            <span class="assignment-points"></span>
            <span class="assignment-due"></span>
          </div>
        </div>
        <div class="assignment-class"></div>
        <div class="assignment-description" data-expanded="false">
          <span class="description-text"></span>
          <span class="description-toggle"></span>
        </div>
      </div>
    </template>

    <template id="modal-body-template">
      <div class="modal-line">
        <strong>Class:</strong> <span class="modal-class"></span>
      </div>
      <div class="modal-line">
        <strong>Due:</strong> <span class="modal-due"></span>
      </div>
      <div class="modal-line modal-points-line">
        <strong>Points:</strong> <span class="modal-points"></span>
      </div>
      <div class="modal-line modal-description-line">
        <strong>Description:</strong>
        <div class="modal-description-content"></div>
      </div>
      <div class="modal-line modal-url-line">
        <a href="#" target="_blank" class="modal-url"> Open Assignment â†’ </a>
      </div>
      <div class="modal-line raw-due-date">
        <strong>Raw due date:</strong> <span class="modal-raw-due"></span>
      </div>
    </template>

    <template id="no-assignments-template">
      <div class="assignment-item">
        <div class="assignment-name"></div>
      </div>
    </template>

    <template id="assignment-dot-template">
      <div class="assignment-dot"></div>
    </template>
  </body>
</html>
