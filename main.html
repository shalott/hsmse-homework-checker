<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HSMSE Homework Checker</title>
    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar Navigation -->
      <aside class="sidebar">
        <header class="app-title">HSMSE Homework Checker</header>

        <!-- Main Controls -->
        <section class="account-section">
          <h2 class="account-title">Controls</h2>
          <div class="account-controls">
            <button id="update-assignments" class="btn btn-primary">
              Update Assignments
            </button>
          </div>
        </section>

        <!-- View Toggle -->
        <section class="view-section">
          <h2 class="view-title">View</h2>
          <div class="view-controls">
            <div class="toggle-switch">
              <input
                type="radio"
                id="assignments-view-toggle"
                name="view-toggle"
                value="assignments"
                checked />
              <label for="assignments-view-toggle">Assignments</label>
              <input
                type="radio"
                id="scraping-view-toggle"
                name="view-toggle"
                value="scraping" />
              <label for="scraping-view-toggle">Scraping</label>
            </div>
          </div>
        </section>

        <!-- Logs Control -->
        <section class="logs-section">
          <h2 class="logs-title">Logs</h2>
          <div class="logs-controls">
            <button id="open-logs" class="btn btn-secondary">
              Open Logs Window
            </button>
          </div>
        </section>

        <!-- Status Section -->
        <section class="status-section">
          <h2 class="status-title">Status</h2>
          <div class="status-info">
            <span id="lastUpdated">Loading assignments...</span>
          </div>
        </section>
      </aside>

      <!-- Main Content Area -->
      <main class="main-content">
        <!-- Error display -->
        <div id="error-box" class="error-box hidden">
          <div class="error-header">
            <span>Encountered Errors</span>
            <button id="error-close-btn" class="error-close-btn">
              &times;
            </button>
          </div>
          <div id="error-messages" class="error-messages"></div>
        </div>

        <!-- Assignment Display (Default View) -->
        <div id="assignment-view" class="assignment-view">
          <!-- Upcoming Assignments Calendar Section -->
          <section class="upcoming-section">
            <!-- Calendar Navigation -->
            <div class="calendar-nav">
              <button id="prevMonth" class="nav-btn">&lt;</button>
              <h3 id="currentMonth">Loading...</h3>
              <button id="nextMonth" class="nav-btn">&gt;</button>
            </div>

            <!-- Calendar Table -->
            <div class="calendar-container">
              <table
                class="calendar-table"
                id="calendarTable"
                aria-label="Calendar">
                <thead>
                  <tr id="calendarHead">
                    <!-- Day headers populated by JavaScript -->
                  </tr>
                </thead>
                <tbody id="calendarBody">
                  <!-- Calendar days populated by JavaScript -->
                </tbody>
              </table>
              <div
                id="classLegend"
                class="class-legend"
                aria-label="Class color legend"></div>
            </div>

            <!-- Upcoming Assignments List -->
            <div class="assignments-list-section">
              <h3>All Upcoming Assignments</h3>
              <div id="upcomingList" class="assignments-list">
                <!-- Upcoming assignments list will be populated by JavaScript -->
              </div>
            </div>
          </section>

          <!-- Missing Assignments Section -->
          <section class="missing-section">
            <h2>Missing Assignments</h2>
            <div id="missingList" class="assignments-list missing-assignments">
              <!-- Missing assignments will be populated by JavaScript -->
            </div>
          </section>

          <!-- Statistics Section -->
          <section class="stats-section">
            <h2>Summary</h2>
            <div class="stats-grid">
              <div class="stat-card">
                <span class="stat-number" id="totalUpcoming">0</span>
                <span class="stat-label">Upcoming</span>
              </div>
              <div class="stat-card">
                <span class="stat-number" id="totalMissing">0</span>
                <span class="stat-label">Missing</span>
              </div>
              <div class="stat-card">
                <span class="stat-number" id="totalAssignments">0</span>
                <span class="stat-label">Total</span>
              </div>
            </div>
          </section>

          <!-- Assignment Details Modal -->
          <div id="assignmentModal" class="modal">
            <div class="modal-content">
              <span class="close">&times;</span>
              <h3 id="modalTitle">Assignment Details</h3>
              <div id="modalBody">
                <!-- Assignment details will be populated here -->
              </div>
            </div>
          </div>
        </div>

        <!-- Browser View (Hidden by default, shown during refresh) -->
        <div id="browser-view" class="browser-content hidden">
          <!-- Instructions Panel -->
          <section id="instructions-panel" class="instructions-panel">
            <h3 class="instructions-title">Instructions</h3>
            <p>
              1. Click "Update Assignments" to log in and gather all assignments
            </p>
            <p>
              2. The system will automatically authenticate and collect data
              from both sources
            </p>
            <p>3. Check the Logs window to monitor progress and results</p>
          </section>

          <!-- BrowserView will be positioned here by Electron -->

          <!-- Jupiter Login Form (Initially Hidden) -->
          <div id="jupiter-login-pane" class="jupiter-login-overlay">
            <div class="jupiter-login-container">
              <h3>Jupiter Ed Login</h3>
              <p>
                Please enter your Jupiter Ed credentials. They will be stored
                securely on your local machine.
              </p>
              <form id="jupiter-form">
                <div class="form-group">
                  <label for="jupiter-student-name">Student Name</label>
                  <input type="text" id="jupiter-student-name" required />
                </div>
                <div class="form-group">
                  <label for="jupiter-password">Password</label>
                  <input type="password" id="jupiter-password" required />
                </div>
                <div class="form-group-inline">
                  <label>Login Type:</label>
                  <div class="radio-group">
                    <input
                      type="radio"
                      id="login-student"
                      name="login-type"
                      value="student"
                      checked />
                    <label for="login-student">Student</label>
                    <input
                      type="radio"
                      id="login-parent"
                      name="login-type"
                      value="parent" />
                    <label for="login-parent">Parent</label>
                  </div>
                </div>
                <button type="submit" class="btn btn-primary">
                  Save and Login
                </button>
              </form>
            </div>
          </div>

          <!-- Suspicious Results Confirmation Dialog (Initially Hidden) -->
          <div
            id="suspicious-results-dialog"
            class="suspicious-results-overlay">
            <div class="suspicious-results-container">
              <h3>⚠️ Suspicious Scraping Results</h3>
              <p>
                Some scrapers returned no assignments, but previous runs had
                assignments. This might indicate a scraping failure.
              </p>

              <div id="suspicious-results-list" class="suspicious-results-list">
                <!-- Dynamic content will be inserted here -->
              </div>

              <div class="suspicious-results-actions">
                <button id="confirm-suspicious-btn" class="btn btn-secondary">
                  Confirm - Use New Results
                </button>
                <button id="reject-suspicious-btn" class="btn btn-primary">
                  Reject - Use Previous Data
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Logs Pane at Bottom -->
        <div class="logs-pane">
          <div class="logs-header">
            <h4>Activity Logs</h4>
            <button id="toggle-logs" class="logs-toggle">−</button>
          </div>
          <div id="log-container" class="log-container">
            <!-- Log entries will be added here dynamically -->
          </div>
        </div>

        <!-- Templates for dynamic content -->
        <template id="assignment-item-template">
          <div class="assignment-item">
            <div class="assignment-header">
              <div class="assignment-name"></div>
              <div class="assignment-meta">
                <span class="assignment-points"></span>
                <span class="assignment-due"></span>
              </div>
            </div>
            <div class="assignment-class"></div>
            <div class="assignment-description" data-expanded="false">
              <span class="description-text"></span>
              <span class="description-toggle"></span>
            </div>
          </div>
        </template>

        <template id="modal-body-template">
          <div class="modal-line">
            <strong>Class:</strong> <span class="modal-class"></span>
          </div>
          <div class="modal-line">
            <strong>Due:</strong> <span class="modal-due"></span>
          </div>
          <div class="modal-line modal-points-line">
            <strong>Points:</strong> <span class="modal-points"></span>
          </div>
          <div class="modal-line modal-description-line">
            <strong>Description:</strong>
            <div class="modal-description-content"></div>
          </div>
          <div class="modal-line modal-url-line">
            <a href="#" target="_blank" class="modal-url">
              Open Assignment →
            </a>
          </div>
        </template>

        <template id="no-assignments-template">
          <div class="assignment-item">
            <div class="assignment-name"></div>
          </div>
        </template>

        <template id="assignment-dot-template">
          <div class="assignment-dot"></div>
        </template>
      </main>
    </div>

    <!-- Status Bar -->
    <footer class="status-bar">
      <div class="status-item url-display">
        <span>URL:</span>
        <span id="status-url">No page loaded</span>
      </div>
      <div class="status-item">
        <span>HSMSE Homework Checker v1.0</span>
      </div>
    </footer>

    <!-- Application JavaScript -->
    <script src="core/renderer.js"></script>
  </body>
</html>
